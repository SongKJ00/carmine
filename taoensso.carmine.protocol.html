<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>taoensso.carmine.protocol documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Carmine</span> <span class="project-version">3.2.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>taoensso</span></div></div></li><li class="depth-2"><a href="taoensso.carmine.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>carmine</span></div></a></li><li class="depth-3 branch"><a href="taoensso.carmine.benchmarks.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>benchmarks</span></div></a></li><li class="depth-3 branch"><a href="taoensso.carmine.commands.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>commands</span></div></a></li><li class="depth-3 branch"><a href="taoensso.carmine.connections.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>connections</span></div></a></li><li class="depth-3 branch"><a href="taoensso.carmine.locks.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>locks</span></div></a></li><li class="depth-3 branch"><a href="taoensso.carmine.message-queue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message-queue</span></div></a></li><li class="depth-3 branch current"><a href="taoensso.carmine.protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocol</span></div></a></li><li class="depth-3 branch"><a href="taoensso.carmine.ring.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ring</span></div></a></li><li class="depth-3"><a href="taoensso.carmine.tundra.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tundra</span></div></a></li><li class="depth-4 branch"><a href="taoensso.carmine.tundra.carmine.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>carmine</span></div></a></li><li class="depth-4 branch"><a href="taoensso.carmine.tundra.disk.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>disk</span></div></a></li><li class="depth-4 branch"><a href="taoensso.carmine.tundra.faraday.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>faraday</span></div></a></li><li class="depth-4"><a href="taoensso.carmine.tundra.s3.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>s3</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-*context*"><div class="inner"><span>*context*</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-*nested-stash-consumed.3F_*"><div class="inner"><span>*nested-stash-consumed?_*</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-*nested-stashed-reqs*"><div class="inner"><span>*nested-stashed-reqs*</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-*parser*"><div class="inner"><span>*parser*</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var--with-replies"><div class="inner"><span>-with-replies</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-execute-requests"><div class="inner"><span>execute-requests</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-get-parsed-reply"><div class="inner"><span>get-parsed-reply</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-get-unparsed-reply"><div class="inner"><span>get-unparsed-reply</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-IByteStr"><div class="inner"><span>IByteStr</span></div></a></li><li class="depth-2"><a href="taoensso.carmine.protocol.html#var-byte-str"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>byte-str</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-no-context-ex"><div class="inner"><span>no-context-ex</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-parse"><div class="inner"><span>parse</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-parse-nippy"><div class="inner"><span>parse-nippy</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-parse-raw"><div class="inner"><span>parse-raw</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-parser-comp"><div class="inner"><span>parser-comp</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-possible-nippy-bytes.3F"><div class="inner"><span>possible-nippy-bytes?</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-raw"><div class="inner"><span>raw</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-return"><div class="inner"><span>return</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-return-parsed-replies"><div class="inner"><span>return-parsed-replies</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-suppressed-reply-kw"><div class="inner"><span>suppressed-reply-kw</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-with-context"><div class="inner"><span>with-context</span></div></a></li><li class="depth-1"><a href="taoensso.carmine.protocol.html#var-with-replies"><div class="inner"><span>with-replies</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">taoensso.carmine.protocol</h1><div class="doc"><pre class="plaintext">Core facilities for communicating with Redis servers using the Redis
request/response protocol, Ref. <a href="http://redis.io/topics/protocol">http://redis.io/topics/protocol</a>.</pre></div><div class="public anchor" id="var-*context*"><h3>*context*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Current dynamic Context
</pre></div></div><div class="public anchor" id="var-*nested-stash-consumed.3F_*"><h3>*nested-stash-consumed?_*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-*nested-stashed-reqs*"><h3>*nested-stashed-reqs*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-*parser*"><h3>*parser*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">ifn (with optional meta) or nil
</pre></div></div><div class="public anchor" id="var--with-replies"><h3>-with-replies</h3><div class="usage"><code>(-with-replies body-fn as-pipeline?)</code></div><div class="doc"><pre class="plaintext">Implementation detail
</pre></div></div><div class="public anchor" id="var-execute-requests"><h3>execute-requests</h3><div class="usage"><code>(execute-requests get-replies? as-pipeline?)</code><code>(execute-requests conn requests get-replies? as-pipeline?)</code></div><div class="doc"><pre class="plaintext">Implementation detail.
Sends given/dynamic requests to given/dynamic Redis server and optionally
blocks to receive the relevant queued (pipelined) parsed replies.</pre></div></div><div class="public anchor" id="var-get-parsed-reply"><h3>get-parsed-reply</h3><div class="usage"><code>(get-parsed-reply in ?parser)</code></div><div class="doc"><pre class="plaintext">Implementation detail
</pre></div></div><div class="public anchor" id="var-get-unparsed-reply"><h3>get-unparsed-reply</h3><div class="usage"><code>(get-unparsed-reply in req-opts)</code></div><div class="doc"><pre class="plaintext">Implementation detail.
BLOCKS to receive a single reply from Redis server and returns the result as
[&lt;type&gt; &lt;reply&gt;]. Redis will reply to commands with different kinds of replies,
identified by their first byte, Ref. <a href="http://redis.io/topics/protocol">http://redis.io/topics/protocol</a>:

  * `+` for simple strings -&gt; &lt;string&gt;
  * `:` for integers       -&gt; &lt;long&gt;
  * `-` for error strings  -&gt; &lt;ex-info&gt;
  * `$` for bulk strings   -&gt; &lt;clj&gt;/&lt;raw-bytes&gt;    ; Marked as serialized
                           -&gt; &lt;bytes&gt;/&lt;raw-bytes&gt;  ; Marked as binary
                           -&gt; &lt;string&gt;/&lt;raw-bytes&gt; ; Unmarked
                           -&gt; nil
  * `*` for arrays         -&gt; &lt;vector&gt;
                           -&gt; nil</pre></div></div><div class="public anchor" id="var-IByteStr"><h3>IByteStr</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-byte-str"><h3>byte-str</h3><div class="usage"><code>(byte-str x)</code></div><div class="doc"><pre class="plaintext">Coerces arbitrary Clojure val to Redis bytestring
</pre></div></div></div></div></div><div class="public anchor" id="var-no-context-ex"><h3>no-context-ex</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-parse"><h3>parse</h3><h4 class="type">macro</h4><div class="usage"><code>(parse f &amp; body)</code></div><div class="doc"><pre class="plaintext">Wraps body so that replies to any wrapped Redis commands will be parsed with
`(f reply)`. Replaces any current parser; removes parser when `f` is nil.
See also `parser-comp`.</pre></div></div><div class="public anchor" id="var-parse-nippy"><h3>parse-nippy</h3><h4 class="type">macro</h4><div class="usage"><code>(parse-nippy thaw-opts &amp; body)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-parse-raw"><h3>parse-raw</h3><h4 class="type">macro</h4><div class="usage"><code>(parse-raw &amp; body)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-parser-comp"><h3>parser-comp</h3><div class="usage"><code>(parser-comp f g)</code></div><div class="doc"><pre class="plaintext">Composes parsers when f or g are nnil, preserving metadata
</pre></div></div><div class="public anchor" id="var-possible-nippy-bytes.3F"><h3>possible-nippy-bytes?</h3><div class="usage"><code>(possible-nippy-bytes? x)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-raw"><h3>raw</h3><div class="usage"><code>(raw x)</code></div><div class="doc"><pre class="plaintext">Forces byte[] argument to be sent to Redis as raw, unencoded bytes.
</pre></div></div><div class="public anchor" id="var-return"><h3>return</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Takes values and returns them as part of next reply from Redis server.
Unlike `echo`, does not actually send any data to Redis.</pre></div></div><div class="public anchor" id="var-return-parsed-replies"><h3>return-parsed-replies</h3><div class="usage"><code>(return-parsed-replies preplies as-pipeline?)</code></div><div class="doc"><pre class="plaintext">Implementation detail
</pre></div></div><div class="public anchor" id="var-suppressed-reply-kw"><h3>suppressed-reply-kw</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-with-context"><h3>with-context</h3><h4 class="type">macro</h4><div class="usage"><code>(with-context conn &amp; body)</code></div><div class="doc"><pre class="plaintext">Implementation detail
</pre></div></div><div class="public anchor" id="var-with-replies"><h3>with-replies</h3><h4 class="type">macro</h4><div class="usage"><code>(with-replies :as-pipeline &amp; body)</code><code>(with-replies &amp; body)</code></div><div class="doc"><pre class="plaintext">Alpha - subject to change.
Evaluates body, immediately returning the server's response to any
contained Redis commands (i.e. before enclosing context ends).

As an implementation detail, stashes and then `return`s any replies already
queued with Redis server: i.e. should be compatible with pipelining.

Note on parsers: if you're writing a Redis command (e.g. a fn that is
intended to execute w/in an implicit connection context) and you're using
`with-replies` as an implementation detail (i.e. you're interpreting
replies internally), you probably want `(parse nil (with-replies ...))` to
keep external parsers from leaking into your internal logic.</pre></div></div></div></body></html>